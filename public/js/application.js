angular.module("MyApp",["ui.router","satellizer"]).config(["$stateProvider","$urlRouterProvider","$authProvider","$locationProvider",function(t,e,r,o){function a(t,e){console.log("skip if is auth"),e.isAuthenticated()&&t.go("home")}function n(t,e){e.isAuthenticated()||t.go("login")}a.$inject=["$state","$auth"],n.$inject=["$state","$auth"],o.hashPrefix(""),t.state("home",{url:"/home",templateUrl:"partials/home.html"}).state("contact",{url:"/contact",templateUrl:"partials/contact.html",controller:"ContactCtrl"}).state("login",{url:"/login",templateUrl:"partials/login.html",controller:"LoginCtrl",resolve:{skipIfAuthenticated:a}}).state("signup",{url:"/signup",templateUrl:"partials/signup.html",controller:"SignupCtrl",resolve:{skipIfAuthenticated:a}}).state("account",{url:"/account",templateUrl:"partials/profile.html",controller:"ProfileCtrl",resolve:{loginRequired:n}}).state("reset",{url:"/reset/:token",templateUrl:"partials/reset.html",controller:"ResetCtrl"}).state("forgot",{url:"/forgot",templateUrl:"partials/forgot.html",controller:"ForgotCtrl",resolve:{skipIfAuthenticated:a}}),e.otherwise("/home"),r.loginUrl="/login",r.signupUrl="/signup"}]).run(["$rootScope","$window",function(t,e){e.localStorage.user&&(t.currentUser=JSON.parse(e.localStorage.user))}]),angular.module("MyApp").controller("ContactCtrl",["$scope","Contact",function(t,e){t.sendContactForm=function(){e.send(t.contact).then(function(e){t.messages={success:[e.data]}})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})}}]),angular.module("MyApp").controller("ForgotCtrl",["$scope","Account",function(t,e){t.forgotPassword=function(){e.forgotPassword(t.user).then(function(e){t.messages={success:[e.data]}})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})}}]),angular.module("MyApp").controller("HeaderCtrl",["$scope","$state","$window","$auth",function(t,e,r,o){t.isActive=function(t){return t===e.href()},t.isAuthenticated=function(){return o.isAuthenticated()},t.logout=function(){o.logout(),delete r.localStorage.user,e.go("home")}}]),angular.module("MyApp").controller("LoginCtrl",["$scope","$rootScope","$state","$window","$auth",function(t,e,r,o,a){t.login=function(){a.login(t.user).then(function(t){e.currentUser=t.data.user,o.localStorage.user=JSON.stringify(t.data.user),r.go("account")})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})},t.authenticate=function(n){a.authenticate(n).then(function(t){e.currentUser=t.data.user,o.localStorage.user=JSON.stringify(t.data.user),r.go("home")})["catch"](function(e){e.error?t.messages={error:[{msg:e.error}]}:e.data&&(t.messages={error:[e.data]})})}}]),angular.module("MyApp").controller("ProfileCtrl",["$scope","$rootScope","$state","$window","$auth","Account",function(t,e,r,o,a,n){t.profile=e.currentUser,t.updateProfile=function(){n.updateProfile(t.profile).then(function(r){e.currentUser=r.data.user,o.localStorage.user=JSON.stringify(r.data.user),t.messages={success:[r.data]}})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})},t.changePassword=function(){n.changePassword(t.profile).then(function(e){t.messages={success:[e.data]}})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})},t.link=function(e){a.link(e).then(function(e){t.messages={success:[e.data]}})["catch"](function(e){o.scrollTo(0,0),t.messages={error:[e.data]}})},t.unlink=function(e){a.unlink(e).then(function(){t.messages={success:[response.data]}})["catch"](function(e){t.messages={error:[e.data]}})},t.deleteAccount=function(){n.deleteAccount().then(function(){a.logout(),delete o.localStorage.user,r.go("home")})["catch"](function(e){t.messages={error:[e.data]}})}}]),angular.module("MyApp").controller("ResetCtrl",["$scope","Account",function(t,e){t.resetPassword=function(){e.resetPassword(t.user).then(function(e){t.messages={success:[e.data]}})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})}}]),angular.module("MyApp").controller("SignupCtrl",["$scope","$rootScope","$state","$window","$auth",function(t,e,r,o,a){t.signup=function(){a.signup(t.user).then(function(t){a.setToken(t),e.currentUser=t.data.user,o.localStorage.user=JSON.stringify(t.data.user),r.go("home")})["catch"](function(e){t.messages={error:Array.isArray(e.data)?e.data:[e.data]}})},t.authenticate=function(n){a.authenticate(n).then(function(t){e.currentUser=t.data.user,o.localStorage.user=JSON.stringify(t.data.user),r.go("home")})["catch"](function(e){e.error?t.messages={error:[{msg:e.error}]}:e.data&&(t.messages={error:[e.data]})})}}]),angular.module("MyApp").factory("Account",["$http","$state",function(t,e){return{updateProfile:function(e){return t.put("/account",e)},changePassword:function(e){return t.put("/account",e)},deleteAccount:function(){return t["delete"]("/account")},forgotPassword:function(e){return t.post("/forgot",e)},resetPassword:function(r){return console.log(e.params),t.post("/reset/"+e.params.token,r)}}}]),angular.module("MyApp").factory("Contact",["$http",function(t){return{send:function(e){return t.post("/contact",e)}}}]);